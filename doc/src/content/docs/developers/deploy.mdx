---
title: Deploying to Production
description: This document explains how to deploy Atomic CRM to production.
---

## Deploying The Backend

The entire backend of Atomic CRM is hosted on Supabase. The backend is composed of a Postgres database, a REST API, and edge functions. Check out the [Supabase Configuration](../supabase-configuration) section for details.

After [configuring your Supabase instance](../supabase-configuration), you can deploy the backend changes with the following command:

```sh
make supabase-deploy
```

Make sure you access the frontend once to initialize the main admin account.

## Testing Production Mode

If you want to test you local frontend code using the remote Supabase instance and the production settings, you can run the following command:

```sh
make prod-start
```

Note: It will apply migrations and deploy edge functions.

You can then access the app via [`http://localhost:3000/`](http://localhost:3000/).

## Deploying The Frontend

The frontend of the CRM is a Single-Page App that can be deployed to any CDN. The production deployment uses **Netlify**, while GitHub Pages is used for demo deployments.

### Netlify Deployment (Production & Staging)

The repository includes a `netlify.toml` configuration file that handles:
- **Production deployment** from the `main` branch
- **Staging deployment** from the `stage` branch
- **Preview deployments** for pull requests

**Setup Steps:**

1. **Import Repository to Netlify**
   - Go to Netlify dashboard and import the repository
   - Netlify will auto-detect the build settings from `netlify.toml`

2. **Configure Environment Variables**

   In Netlify Site Settings → Environment Variables, add:
   - `SUPABASE_URL` - Your Supabase project URL
   - `SUPABASE_ANON_KEY` - Your Supabase anonymous key
   - `VITE_INBOUND_EMAIL` - Inbound email address (optional)

   For staging, add branch-specific variables scoped to the `stage` branch with staging Supabase credentials.

3. **Deploy**
   - Push to `main` branch for production deployment
   - Push to `stage` branch for staging deployment
   - Open a PR for preview deployment

The built app will be available at:
- Production: `https://[site-name].netlify.app`
- Staging: `https://stage--[site-name].netlify.app`

### Manual Build

To build the frontend locally:

```sh
make build
```

This creates a `dist` directory with static HTML, CSS, and JS files that can be uploaded to any CDN.

### GitHub Pages (Demo Only)

GitHub Pages is used exclusively for demo deployments. The demo uses fake data and does not connect to Supabase.

To deploy the demo manually:

```sh
npm run ghpages:deploy
```

The demo will be available at `https://<username>.github.io/atomic-crm/`.

## Deploying Updates

To deploy updates to your production CRM:

### Backend Updates

Deploy Supabase migrations and edge functions:

```sh
make supabase-deploy
```

Or manually:

```sh
npx supabase db push          # Apply migrations
npx supabase functions deploy # Deploy edge functions
```

### Frontend Updates

**Netlify (Production & Staging):**

Frontend updates deploy automatically when you push to:
- `main` branch → Production
- `stage` branch → Staging

**Demo (GitHub Pages):**

Deploy demo manually:

```sh
npm run ghpages:deploy
```

### Full Deployment

To deploy everything at once (backend + demo):

```sh
make prod-deploy
```

This applies migrations, deploys edge functions, and pushes the demo to GitHub Pages. Production frontend deploys automatically via Netlify when you push to `main`.

## Automating Deployments With GitHub Actions

Atomic CRM includes GitHub Actions workflows for continuous integration and delivery. On every push to the `main` branch:

1. **Backend (Supabase)** - Deploys database migrations and edge functions
2. **Frontend (Netlify)** - Automatically deploys via Netlify's GitHub integration
3. **Demo (GitHub Pages)** - Deploys demo variant with fake data

### GitHub Secrets Configuration

To enable backend deployments, configure the following secrets in your GitHub repository:

```bash
SUPABASE_ACCESS_TOKEN: Your personal access token (https://supabase.com/dashboard/account/tokens)
SUPABASE_DB_PASSWORD: Your Supabase database password
SUPABASE_PROJECT_ID: Your Supabase project ID
SUPABASE_URL: Your Supabase project URL
SUPABASE_ANON_KEY: Your Supabase anonymous key
POSTMARK_WEBHOOK_USER: User for Postmark webhook authentication
POSTMARK_WEBHOOK_PASSWORD: Password for Postmark webhook authentication
POSTMARK_WEBHOOK_AUTHORIZED_IPS: Comma-separated IPs authorized for Postmark webhook
```

> **Note:** The `POSTMARK_*` variables are required for inbound email features. See [inbound email configuration](../inbound-email-configuration) for setup details.

### Deployment Flow

**On push to `main`:**
- GitHub Actions deploys Supabase backend (migrations + functions)
- Netlify automatically builds and deploys production frontend
- GitHub Actions deploys demo variant to GitHub Pages

**On push to `stage`:**
- Netlify automatically builds and deploys staging frontend
- Supabase staging updates are deployed manually or via separate workflow

**On pull request:**
- Netlify creates preview deployment with unique URL
